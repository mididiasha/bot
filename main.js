const { Bot } = require('grammy');

const bot = new Bot('8143064543:AAGOQ89NGj4cHSLNdg8JoT8ghqQP-EZTs9g');

// –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
const participants = {};

// –í–æ–ø—Ä–æ—Å—ã –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
const questions = [
    {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ HTML?",
        options: ["–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏", "–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è", "–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö"],
        answer: 0
    },
     {
        question: "–ö–∞–∫–æ–π —Ç–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è?",
        options: ["<h1>", "<header>", "<title>"],
        answer: 0
    },
     {
        question: " –ö–∞–∫ –≤—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É?",
        options: ["<src='image.jpg' alt='–û–ø–∏—Å–∞–Ω–∏–µ'>", "<image src='image.jpg' alt='–û–ø–∏—Å–∞–Ω–∏–µ'>", "<img src='image.jpg' alt='–û–ø–∏—Å–∞–Ω–∏–µ'>"],
        answer: 2
    },
     {
        question: "–ö–∞–∫–æ–π —Ç–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∏?",
        options: ["<link>", "<a>", "<href>"],
        answer: 1
    },
     {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∞—Ç—Ä–∏–±—É—Ç id –≤ HTML?",
        options: ["–°–ø–æ—Å–æ–± –≤—Å—Ç–∞–≤–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤", "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ —ç–ª–µ–º–µ–Ω—Ç–∞", "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"],
        answer: 2
    },
    {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ CSS?",
        options: ["–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏", "–Ø–∑—ã–∫ —Å—Ç–∏–ª–µ–π", "–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è"],
        answer: 1
    },
    {
        question: "–ö–∞–∫–æ–π —Å–µ–ª–µ–∫—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –µ–≥–æ –∫–ª–∞—Å—Å—É?",
        options: ["#classname", ".classname", "classname"],
        answer: 1
    },
    {
        question: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ 'display: none;'?",
        options: [" –≠–ª–µ–º–µ–Ω—Ç —Å–∫—Ä—ã—Ç –∏ –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ", "–≠–ª–µ–º–µ–Ω—Ç —Å–∫—Ä—ã—Ç, –Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ", "–≠–ª–µ–º–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –±–ª–æ–∫"],
        answer: 0
    },
    {
        question: "–ö–∞–∫ –∑–∞–¥–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞?",
        options: ["margin", "border", "padding"],
        answer: 2
    },
    {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞—Å–∫–∞–¥–Ω–æ—Å—Ç—å –≤ CSS?",
        options: ["–°–ø–æ—Å–æ–± –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å—Ç–∏–ª–µ–π", "–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç–∏–ª–µ–π", " –ú–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∏–ª–µ–π"],
        answer: 1
    },
    {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ JavaScript?",
        options: ["–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏", "–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è", "–Ø–∑—ã–∫ —Å—Ç–∏–ª–µ–π"],
        answer: 1
    },
    {
        question: "–ö–∞–∫ –æ–±—ä—è–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ JavaScript —Å –ø–æ–º–æ—â—å—é 'let'?",
        options: ["variable x = 10", "var x = 10;", "let x = 10;"],
        answer: 2
    },
    {
        question: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ—É–Ω–∫—Ü–∏—è –≤ JavaScript?",
        options: ["–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö", "–ë–ª–æ–∫ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –∏ –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –∑–∞–¥–∞—á—É", "–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∏—Å–µ–ª"],
        answer: 1
    },
    {
        question: "–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä '===' –≤ JavaScript?",
        options: ["–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∏ —Ç–∏–ø—É", "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ —Ç–æ–ª—å–∫–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é", "–ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π"],
        answer: 0
    },
    {
        question: "–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è x  —á–∏—Å–ª–æ–º?",
        options: ["typeof x === 'number'", "isNumber(x)", "x instanceof Number"],
        answer: 0
    }
];

// –ö–æ–º–∞–Ω–¥–∞ /start
bot.command('start', (ctx) => {
    ctx.reply('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≤–∏–∫—Ç–æ—Ä–∏–Ω—É! –í–≤–µ–¥–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.');
});

// –ö–æ–º–∞–Ω–¥–∞ /register
bot.command('register', (ctx) => {
    const userId = ctx.from.id;
    if (!participants[userId]) {
        participants[userId] = { score: 0, currentQuestion: 0 };
        ctx.reply('–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã! –ù–∞—á–∏–Ω–∞–µ–º –≤–∏–∫—Ç–æ—Ä–∏–Ω—É. –í–≤–µ–¥–∏—Ç–µ /next –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.');
    } else {
        ctx.reply('–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã. –í–≤–µ–¥–∏—Ç–µ /next –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.');
    }
});

// –ö–æ–º–∞–Ω–¥–∞ /next
bot.command('next', (ctx) => {
    const userId = ctx.from.id;
    if (!participants[userId]) {
        return ctx.reply('–°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, –≤–≤–µ–¥—è /register.');
    }

    const participant = participants[userId];
    const questionIndex = participant.currentQuestion;

    if (questionIndex < questions.length) {
        const question = questions[questionIndex];
        const options = question.options.map((option, index) => `${index + 1}. ${option}`).join('\n');
        ctx.reply(`${question.question}\n${options}`);
    } else {
        ctx.reply(`–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${participant.score} –∏–∑ ${questions.length}`);
      
    }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
bot.on('message', (ctx) => {
    const userId = ctx.from.id;
    const participant = participants[userId];

    if (!participant) return;

    const answer = parseInt(ctx.message.text) - 1;
    const questionIndex = participant.currentQuestion;

    if (questionIndex < questions.length) {
        if (answer === questions[questionIndex].answer) {
            participant.score++;
            ctx.reply('–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üéâ');
        } else {
            ctx.reply('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. üò¢');
        }
        participant.currentQuestion++;
        ctx.reply('–í–≤–µ–¥–∏—Ç–µ /next –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.');
    }
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª

// –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.start();

